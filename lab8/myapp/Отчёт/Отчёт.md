1. Цель работы:

  Разработать веб-приложение по отслеживанию курсов валют с использованием MVC архитектуры
  
  Реализовать модели с геттерами/сеттерами (Author, App, User, Currency, UserCurrency)
  
  Создать HTTPServer без фреймворков
  
  Интегрировать Jinja2 шаблонизатор
  
  Подключить API курсов валют ЦБ РФ
  
  Реализовать подписки пользователей на валюты
  
  Самостоятельная работа: Графики динамики курсов за 3 месяца

2. Описание предметной области:

                       Author 1───┐
           ├───App 1───┐
           │           ├───User * ─── UserCurrency * ─── Currency *
           └───         │
                       └───Subscription (связь)
Модель – Свойства – Описание

Author – name, group – Автор приложения

App – name, version, author – Метаданные приложения

User – id, name, subscriptions[] – Пользователь + подписки

Currency – id, char_code, name, value – Валюта

UserCurrency – user_id, currency_id – Связующая таблица

3. Структура проекта

```
D:\Lab8\myapp\
├── myapp.py                 # HTTPServer + Контроллер (MVC)
├── test_models.py           # Unit-тесты моделей
│
├── models/                  # Модели (Model)
│   ├── __init__.py          # Пустой пакет
│   ├── author.py            # Author(name, group)
│   ├── app.py               # App(name, version, author)
│   ├── user.py              # User(id, name) + subscriptions
│   ├── currency.py          # Currency(id, char_code, value)
│   └── user_currency.py     # UserCurrency(user_id, currency_id)
│
├── templates/               # Представления (View) - Jinja2
│   ├── index.html           # Главная страница
│   ├── users.html           # Список пользователей
│   ├── currencies.html      # Курсы валют
│   └── user.html            # Профиль + графики
│
├── static/                  # Статические файлы
│   └── style.css            # Стили CSS
│
└── utils/                   # Утилиты
    └── currencies_api.py    # API ЦБ РФ + история курсов
```

4. Описание реализации
 
  4.1 Модели с геттерами/сеттерами:
  ```
  # models/user.py
    class User:
    
    def __init__(self, user_id: str, name: str):
        self._id = user_id      # Приватное поле
        self._name = name
        self._subscriptions = [] # Список подписок
    
    @property
    def id(self) -> str:        # Геттер
        return self._id
    
    @property  
    def name(self) -> str:      # Геттер
        return self._name
    
    def add_subscription(self, sub):  # Метод
        self._subscriptions.append(sub)
   ```
   4.2 Маршрутизация HTTPServer:
   ```
  # myapp.py - Контроллер (MVC)
     def do_GET(self):
        if self.path == '/':           # → index.html
            self.handle_index()
        elif self.path == '/users':    # → users.html  
            self.handle_users()
        elif self.path.startswith('/user'):  # → user.html
            self.handle_user()
   ```      
   4.3. Jinja2 Environment:
   ```
   # Инициализация один раз при первом запросе
    cls.env = Environment(
      loader=FileSystemLoader("templates"),  # Папка templates/
      autoescape=select_autoescape()         # Защита от XSS
      )
    cls.templates = {
      'index': cls.env.get_template("index.html"),
      'user': cls.env.get_template("user.html")
      }
   ```
4.4. Интеграция API курсов:
  ```
  # utils/currencies_api.py
def get_currencies(['USD', 'EUR']):
    return {'USD': 91.2543, 'EUR': 99.8231}  # ЦБ РФ XML → JSON
  ```

5. Примеры работы приложения

см. скриншоты в папке "Отчёт"

6. Самостоятельная работа: Графики динамики

см. скриншоты в папке "Отчёт"

Реализация:
```
# utils/currencies_api.py
def get_currency_history('USD'):  # 90 дней данных
    return [{'date': '2025-12-01', 'value': 91.25}, ...]

# templates/user.html + Chart.js CDN
<canvas id="chart-USD"></canvas>
<script> new Chart(ctx, { type: 'line', data: [...] }); </script>
```
Результат: Линейный график USD/RUB за 90 дней с колебаниями ±2%

Библиотеки:

Chart.js - отрисовка графиков

Python datetime - генерация дат

random - симуляция рыночных колебаний

7. Тестирование

см. скриншоты в папке "Отчёт"

Тесты проверяют:

Геттеры user.name, author.group

Методы add_subscription()

Создание объектов

8. Выводы

Проблемы:

IndentationError - смешанные Tab+пробелы

Jinja2 TemplateNotFound - отсутствовали HTML файлы

HTTPServer __init__ - нельзя переопределять в Python 3.13

PackageLoader vs FileSystemLoader - неправильный путь к templates

MVC принципы:
```
Model     → models/*.py (User, Author, данные)
View      → templates/*.html (Jinja2)
Controller→ myapp.py (HTTPServer маршруты)
```
Новое:

HTTPServer без фреймворков = понимание HTTP "изнутри"

Jinja2 = мощный шаблонизатор (наследование, блоки)

API ЦБ РФ = парсинг XML → JSON

Chart.js = клиентские графики из серверных данных
