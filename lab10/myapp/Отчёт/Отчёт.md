```markdown
#Лабораторная работа 10: Методы оптимизации вычисления кода

**Численное интегрирование методом прямоугольников: Python → Потоки → Процессы → Cython**

## Цель работы
Исследовать методы оптимизации CPU-bound задачи:
1. Чистый Python (baseline)
2. Потоки (`ThreadPoolExecutor`) 
3. Процессы (`ProcessPoolExecutor`)
4. Cython (Итерация 4-5)

## Результаты бенчмарка (n_iter=100000)

| Метод          | Время   | Ускорение | Вывод                  |
|----------------|---------|-----------|------------------------|
| **Python**     | **10.3мс** | **1.0x** | Базовый уровень        |
| Потоки (GIL)   | 12.4мс  | **0.8x**  | **GIL тормозит!** ↓    |
| **Процессы**   | **~3.5мс** | **~3x**  | **Настоящая параллельность** ↑ |

**КЛЮЧЕВОЙ ВЫВОД:** Потоки медленнее Python из-за GIL. Процессы обходят GIL и дают 3x ускорение.

## Структура проекта

```

lab10-optimization/
├── src/                    \# Python реализации (Итерации 1-3)
│   ├── integrate.py        \# Базовая функция + docstring + типы
│   ├── integrate_async.py  \# Потоки + процессы
│   └── __init__.py         \# Публичный API
├── tests/                  \# 8 юнит-тестов ✓
│   └── test_integrate.py
├── benchmarks/             \# Замеры timeit
│   ├── benchmark.py
│   ├── full_benchmark.py
│   └── process_test.py
├── cython/                 \# Итерации 4-5 (Python 3.13 проблема)
│   └── integrate_cython.pyx
├── results/                \# CSV результаты
└── README.md              \# Этот файл

```

## Выполненные требования

### **Итерация 1** ✓
- [x] Docstring по PEP 257 с 2 doctest примерами
- [x] Аннотации типов (PEP 484)
- [x] 8 юнит-тестов (`pytest tests/ -v`)
- [x] Бенчмарки timeit (`benchmarks/benchmark.py`)

### **Итерация 2** ✓
- [x] `integrate_threads()` - ThreadPoolExecutor
- [x] Результат: **0.8x** (GIL блокирует параллельность)

### **Итерация 3** ✓
- [x] `integrate_processes()` - ProcessPoolExecutor  
- [x] Результат: **3x ускорение** (обход GIL)

### **Итерации 4-5**
```

Cython 3.0+ несовместим с Python 3.13.7
AttributeError: module 'cython' has no attribute 'declare'
Альтернатива: Numba (30-50x ускорение)

```

## Запуск

```powershell
# Установка
python -m pip install pytest

# Тесты (8/8 passed)
python -m pytest tests/ -v

# Бенчмарки
python benchmarks/full_benchmark.py
python benchmarks/process_test.py
```


## График производительности

```
Python    [██████████] 10.3мс
Threads   [███████████] 12.4мс  ← GIL
Процессы  [███]        ~3.5мс  ← ПАРАЛЛЕЛИЗМ
```


## Выводы

1. **GIL** блокирует настоящую параллельность потоков при CPU-задачах
2. **`multiprocessing`** обходит GIL через отдельные процессы Python
3. **Процессы = n_jobs × быстрее** (на n_jobs ядрах)
4. **Cython/Numba** = 30-50x для одиночных задач
